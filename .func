# 第1引数の数が第2引数未満だったら1を返す
# ex: `check_arg $# 0 
local check_arg() {
  if [[ ${1} -lt ${2} ]]; then
    echo "Error: 引数が不足しています" 1>&2
    return 1
  fi
}

comp() {
  file=${1/.*}
  shift
  
  executable_extension="out"
  separator="-----"

  compile="${CC:-clang} -Wall ${CFLAGS} -o ${file}.${executable_extension} ${file}.c"
  run="./${file}.${executable_extension} ${@}"

  # コンパイル（失敗時にスクリプトを終了させる）
  echo ${compile}
  bash -c "${compile}" || return 1

  # コマンドを実行する
  echo "${separator}"
  bash -c "${run}"
  echo "${separator}"
}

# C++のコードを即席で実行しちゃうぞ
# instantcppだとにてる名前のコマンド多くて補完がだめ
cppinstant() {
  src=$(mktemp --suffix=.cpp)
  cat << END > ${src}
#include <bits/stdc++.h>
using namespace std;

int main() {

}
END
  out=$(mktemp --suffix=.out)
  nvim ${src}
  g++ -Wall -o ${out} ${src} && ${out}
  rm -f ${src} ${out}
}

calc() {
  python3 -c "print(${@})"
}

sshclone() {
  check_arg $# 1 || return 1
  git clone git@github.com:${@}
}

asm() {
  check_arg $# 1 || return 1
  nasm -g -f elf64 ${1} -o a.o && ld -m elf_x86_64 a.o && rm a.o
}
